AUI.add("liferay-export-import",function(b){var h=b.Lang;var l=b.Date;var k=10000;var e=/plid_(\d+)/;var d=60000;var j=2000;var g="checked";var a="click";var i="";var f={setter:"_setNode"};var c=b.Component.create({ATTRS:{archivedSetupsNode:f,commentsNode:f,deleteMissingLayoutsNode:f,deletePortletDataNode:f,deletionsNode:f,form:f,incompleteProcessMessageNode:f,layoutSetSettingsNode:f,logoNode:f,processesNode:f,rangeAllNode:f,rangeDateRangeNode:f,rangeLastNode:f,rangeLastPublishNode:f,ratingsNode:f,remoteAddressNode:f,remoteDeletePortletDataNode:f,remotePortNode:f,remotePathContextNode:f,remoteGroupIdNode:f,secureConnectionNode:f,setupNode:f,themeReferenceNode:f,userPreferencesNode:f},AUGMENTS:[Liferay.PortletBase],EXTENDS:b.Base,NAME:"exportimport",prototype:{initializer:function(n){var m=this;m._bindUI();m._layoutsExportTreeOutput=m.byId(n.pageTreeId+"Output");m._initLabels();m._processesResourceURL=n.processesResourceURL;b.later(j,m,m._renderProcesses)},destructor:function(){var m=this;if(m._contentOptionsDialog){m._contentOptionsDialog.destroy()}if(m._globalConfigurationDialog){m._globalConfigurationDialog.destroy()}if(m._globalContentDialog){m._globalContentDialog.destroy()}if(m._pagesDialog){m._pagesDialog.destroy()}if(m._rangeDialog){m._rangeDialog.destroy()}if(m._remoteDialog){m._remoteDialog.destroy()}if(m._scheduledPublishingEventsDialog){m._scheduledPublishingEventsDialog.destroy()}},_bindUI:function(){var s=this;var n=s.get("form");if(n){n.delegate(a,function(y){var x=y.currentTarget.attr("data-portletid");var v=y.currentTarget.attr("data-portlettitle");if(!v){v=Liferay.Language.get("configuration")}var w=s._getConfigurationDialog(x,v);w.show()},".configuration-link");n.delegate(a,function(x){var w=x.currentTarget.attr("data-portletid");var v=x.currentTarget.attr("data-portlettitle");if(!v){v=Liferay.Language.get("content")}var y=s._getContentDialog(w,v);y.show()},".content-link")}var p=s.byId("contentOptionsLink");if(p){p.on(a,function(v){var w=s._getContentOptionsDialog();w.show()})}var q=s.byId("globalConfigurationLink");if(q){q.on(a,function(w){var v=s._getGlobalConfigurationDialog();v.show()})}var t=s.byId("globalContentLink");if(t){t.on(a,function(v){var w=s._getGlobalContentDialog();w.show()})}var u=s.byId("pagesLink");if(u){u.on(a,function(w){var v=s._getPagesDialog();v.show()})}var o=s.byId("rangeLink");if(o){o.on(a,function(w){var v=s._getRangeDialog();v.show()})}var m=s.byId("remoteLink");if(m){m.on(a,function(w){var v=s._getRemoteDialog();v.show()})}var r=s.byId("scheduledPublishingEventsLink");if(r){r.on(a,function(w){var v=s._getScheduledPublishingEventsDialog();v.show()})}},_getConfigurationDialog:function(q,n){var m=this;var o=m.byId("configuration_"+q);var p=o.getData("configurationDialog");if(!p){o.show();p=Liferay.Util.Window.getWindow({dialog:{bodyContent:o,centered:true,height:300,modal:true,render:m.get("form"),toolbars:{footer:[{on:{click:function(r){r.domEvent.preventDefault();m._setConfigurationLabels(q);p.hide()}},label:Liferay.Language.get("ok"),primary:true},{on:{click:function(r){r.domEvent.preventDefault();p.hide()}},label:Liferay.Language.get("cancel")}]},width:400},title:n});o.setData("configurationDialog",p)}return p},_getContentDialog:function(p,o){var n=this;var m=n.byId("content_"+p);var q=m.getData("contentDialog");if(!q){m.show();q=Liferay.Util.Window.getWindow({dialog:{bodyContent:m,centered:true,height:300,modal:true,render:n.get("form"),toolbars:{footer:[{on:{click:function(r){r.domEvent.preventDefault();n._setContentLabels(p);q.hide()}},label:Liferay.Language.get("ok"),primary:true},{on:{click:function(r){r.domEvent.preventDefault();q.hide()}},label:Liferay.Language.get("cancel")}]},width:400},title:o});m.setData("contentDialog",q)}return q},_getContentOptionsDialog:function(){var n=this;var o=n._contentOptionsDialog;if(!o){var m=n.byId("contentOptions");m.show();o=Liferay.Util.Window.getWindow({dialog:{bodyContent:m,centered:true,height:300,modal:true,render:n.get("form"),toolbars:{footer:[{on:{click:function(p){p.domEvent.preventDefault();n._setContentOptionsLabels();o.hide()}},label:Liferay.Language.get("ok"),primary:true},{on:{click:function(p){p.domEvent.preventDefault();o.hide()}},label:Liferay.Language.get("cancel")}]},width:400},title:Liferay.Language.get("comments,-ratings-and-deletions")});n._contentOptionsDialog=o}return o},_getGlobalConfigurationDialog:function(){var m=this;var o=m._globalConfigurationDialog;if(!o){var n=m.byId("globalConfiguration");n.show();o=Liferay.Util.Window.getWindow({dialog:{bodyContent:n,centered:true,height:300,modal:true,render:m.get("form"),toolbars:{footer:[{on:{click:function(p){p.domEvent.preventDefault();m._setGlobalConfigurationLabels();o.hide()}},label:Liferay.Language.get("ok"),primary:true},{on:{click:function(p){p.domEvent.preventDefault();o.hide()}},label:Liferay.Language.get("cancel")}]},width:400},title:Liferay.Language.get("application-configuration")});m._globalConfigurationDialog=o}return o},_getGlobalContentDialog:function(){var m=this;var o=m._globalContentDialog;if(!o){var n=m.byId("globalContent");n.show();o=Liferay.Util.Window.getWindow({dialog:{bodyContent:n,centered:true,height:300,modal:true,render:m.get("form"),toolbars:{footer:[{on:{click:function(p){p.domEvent.preventDefault();m._setGlobalContentLabels();o.hide()}},label:Liferay.Language.get("ok"),primary:true},{on:{click:function(p){p.domEvent.preventDefault();o.hide()}},label:Liferay.Language.get("cancel")}]},width:400},title:Liferay.Language.get("all-content")});m._globalContentDialog=o}return o},_getPagesDialog:function(){var n=this;var m=n._pagesDialog;if(!m){var o=n.byId("pages");o.show();m=Liferay.Util.Window.getWindow({dialog:{bodyContent:o,centered:true,height:300,modal:true,render:n.get("form"),toolbars:{footer:[{on:{click:function(p){p.domEvent.preventDefault();if(n._layoutsExportTreeOutput){n._reloadForm()}m.hide()}},label:Liferay.Language.get("ok"),primary:true},{on:{click:function(p){p.domEvent.preventDefault();m.hide()}},label:Liferay.Language.get("cancel")}]},width:400},title:Liferay.Language.get("pages")});n._pagesDialog=m}return m},_getRangeDialog:function(){var n=this;var o=n._rangeDialog;if(!o){var m=n.byId("range");m.show();o=Liferay.Util.Window.getWindow({dialog:{bodyContent:m,centered:true,height:375,modal:true,render:n.get("form"),toolbars:{footer:[{on:{click:function(p){p.domEvent.preventDefault();var z=true;var u=true;var q=true;if(n._isChecked("rangeDateRangeNode")){var B=Liferay.component(n.ns("startDateDatePicker"));var t=Liferay.component(n.ns("startTimeTimePicker"));var x=Liferay.component(n.ns("endDateDatePicker"));var A=Liferay.component(n.ns("endTimeTimePicker"));var s=B.getDate();var r=t.getTime();s.setHours(r.getHours());s.setMinutes(r.getMinutes());s.setSeconds(0);s.setMilliseconds(0);var w=x.getDate();var v=A.getTime();w.setHours(v.getHours());w.setMinutes(v.getMinutes());w.setSeconds(0);w.setMilliseconds(0);z=l.isGreater(w,s);var y=new Date();u=l.isGreaterOrEqual(y,w);q=l.isGreaterOrEqual(y,s)}if(z&&u&&q){n._reloadForm();o.hide()}else{var C;if(!z){C=Liferay.Language.get("end-date-must-be-greater-than-start-date")}else{if(!u||!q){C=Liferay.Language.get("selected-dates-cannot-be-in-the-future")}}if(n._notice){n._notice.remove()}n._notice=new Liferay.Notice({closeText:false,content:C+'<button type="button" class="close">&times;</button>',timeout:10000,toggleText:false,type:"warning"});n._notice.show()}}},label:Liferay.Language.get("ok"),primary:true},{on:{click:function(p){p.domEvent.preventDefault();o.hide()}},label:Liferay.Language.get("cancel")}]},width:400},title:Liferay.Language.get("date-range")});n._rangeDialog=o}return o},_getRemoteDialog:function(){var n=this;var o=n._remoteDialog;if(!o){var m=n.byId("remote");m.show();o=Liferay.Util.Window.getWindow({dialog:{bodyContent:m,centered:true,height:300,modal:true,render:n.get("form"),toolbars:{footer:[{on:{click:function(p){p.domEvent.preventDefault();n._setRemoteLabels();o.hide()}},label:Liferay.Language.get("ok"),primary:true},{on:{click:function(p){p.domEvent.preventDefault();o.hide()}},label:Liferay.Language.get("cancel")}]},width:400},title:Liferay.Language.get("remote-live-connection-settings")});n._remoteDialog=o}return o},_getScheduledPublishingEventsDialog:function(){var m=this;var n=m._scheduledPublishingEventsDialog;if(!n){var o=m.byId("scheduledPublishingEvents");o.show();n=Liferay.Util.Window.getWindow({dialog:{bodyContent:o,height:300,centered:true,modal:true,render:m.get("form"),toolbars:{footer:[{on:{click:function(p){p.domEvent.preventDefault();n.hide()}},label:Liferay.Language.get("close")}]},width:400},title:Liferay.Language.get("scheduled-events")});m._scheduledPublishingEventsDialog=n}return n},_getValue:function(p){var m=this;var o=i;var n=m.get(p);if(n){o=n.val()}return o},_initLabels:function(){var m=this;m.all(".configuration-link").each(function(o,n,p){m._setConfigurationLabels(o.attr("data-portletid"))});m.all(".content-link").each(function(o,n,p){m._setContentLabels(o.attr("data-portletid"))});m._setContentOptionsLabels();m._setGlobalConfigurationLabels();m._setGlobalContentLabels();m._setPageLabels();m._setRangeLabels();m._setRemoteLabels()},_isChecked:function(o){var m=this;var n=m.get(o);return(n&&n.attr(g))},_reloadForm:function(){var m=this;var n=m.byId("cmd");if(n){n.val(i);submitForm(m.get("form"))}},_renderProcesses:function(){var m=this;var n=m.get("processesNode");if(n){new b.TogglerDelegate({animated:true,closeAllOnExpand:true,container:n,content:".background-task-status-message",expanded:false,header:".details-link",on:{"toggler:expandedChange":function(p){var q=p.target.get("header");var o=0;if(!q.hasClass("toggler-header-collapsed")){o=q.getData("persist-id")}Liferay.Store({"background-task-ids":o})}},transition:{duration:0.3}})}if(n&&m._processesResourceURL){b.io.request(m._processesResourceURL,{on:{failure:function(){new Liferay.Notice({closeText:false,content:Liferay.Language.get("your-request-failed-to-complete")+'<button type="button" class="close">&times;</button>',noticeClass:"hide",timeout:k,toggleText:false,type:"warning",useAnimation:true}).show()},success:function(q,s,r){n.empty();n.plug(b.Plugin.ParseContent);n.setContent(this.get("responseData"));var o=d;var p=!!n.one(".background-task-status-in-progress");if(p){o=j}m._updateincompleteProcessMessage(p,n.one(".incomplete-process-message"));b.later(o,m,m._renderProcesses)}}})}},_setConfigurationLabels:function(p){var m=this;var o=m.byId("configuration_"+p);var n=o.all(".field");var q=[];n.each(function(t,r,u){var s=t.attr(g);if(s){q.push(t.attr("data-name"))}});if(q.length===0){m.byId("PORTLET_CONFIGURATION_"+p+"Checkbox").set("checked",false);m.byId("showChangeConfiguration_"+p).hide()}m._setLabels("configurationLink_"+p,"selectedConfiguration_"+p,q.join(", "))},_setContentLabels:function(q){var n=this;var m=n.byId("content_"+q);var o=m.all(".field");var p=[];o.each(function(t,r,u){var s=t.attr(g);if(s){p.push(t.attr("data-name"))}});if(p.length===0){n.byId("PORTLET_DATA_"+q+"Checkbox").set("checked",false);n.byId("showChangeContent_"+q).hide()}n._setLabels("contentLink_"+q,"selectedContent_"+q,p.join(", "))},_setContentOptionsLabels:function(){var n=this;var o=[];if(n._isChecked("commentsNode")){o.push(Liferay.Language.get("comments"))}if(n._isChecked("deletionsNode")){var m=n.get("deletionsNode");o.push(m.attr("data-name"));n.all(".deletions").each(function(q,p,r){q.show()})}else{n.all(".deletions").each(function(q,p,r){q.hide()})}if(n._isChecked("ratingsNode")){o.push(Liferay.Language.get("ratings"))}n._setLabels("contentOptionsLink","selectedContentOptions",o.join(", "))},_setGlobalConfigurationLabels:function(){var m=this;var n=[];if(m._isChecked("setupNode")){n.push(Liferay.Language.get("setup"))}if(m._isChecked("archivedSetupsNode")){n.push(Liferay.Language.get("archived-setups"))}if(m._isChecked("userPreferencesNode")){n.push(Liferay.Language.get("user-preferences"))}m._setLabels("globalConfigurationLink","selectedGlobalConfiguration",n.join(", "))},_setGlobalContentLabels:function(){var m=this;var n=[];if(m._isChecked("deletePortletDataNode")){n.push(Liferay.Language.get("delete-portlet-data-before-importing"))}m._setLabels("globalContentLink","selectedGlobalContent",n.join(", "))},_setLabels:function(r,q,p){var m=this;var n=m.byId(r);if(n){if(p!==i){n.html(Liferay.Language.get("change"))}else{n.html(Liferay.Language.get("select"))}}var o=m.byId(q);if(o){o.html(p)}},_setNode:function(n){var m=this;if(h.isString(n)){n=m.one(n)}else{n=b.one(n)}return n},_setPageLabels:function(){var m=this;var r=[];if(m._layoutsExportTreeOutput){var q=m.byId("layoutIds");var o=m._layoutsExportTreeOutput.getData("treeInstance");var n=o.item(0);if(n.isChecked()){q.val(i);r.push(Liferay.Language.get("all-pages"))}else{var p=[];o.eachChildren(function(u,t,v){if(u.isChecked()){var s=e.exec(u.get("id"));if(s){p.push({includeChildren:!u.hasChildNodes(),plid:s[1]})}}},true);if(q){q.val(b.JSON.stringify(p))}r.push(Liferay.Language.get("selected-pages"))}}if(m._isChecked("deleteMissingLayoutsNode")){r.push(Liferay.Language.get("delete-missing-layouts"))}if(m._isChecked("layoutSetSettingsNode")){r.push(Liferay.Language.get("site-pages-settings"))}if(m._isChecked("themeReferenceNode")){r.push(Liferay.Language.get("theme-settings"))}if(m._isChecked("logoNode")){r.push(Liferay.Language.get("logo"))}m._setLabels("pagesLink","selectedPages",r.join(", "))},_setRangeLabels:function(){var m=this;var n=i;if(m._isChecked("rangeAllNode")){n=Liferay.Language.get("all")}else{if(m._isChecked("rangeLastPublishNode")){n=Liferay.Language.get("from-last-publish-date")}else{if(m._isChecked("rangeDateRangeNode")){n=Liferay.Language.get("date-range")}else{if(m._isChecked("rangeLastNode")){n=Liferay.Language.get("last")}}}}m._setLabels("rangeLink","selectedRange",n)},_setRemoteLabels:function(){var m=this;var q=[];var r=m._getValue("remoteAddressNode");if(r!==i){q.push(r)}var p=m._getValue("remotePortNode");if(p!==i){q.push(p)}var o=m._getValue("remotePathContextNode");if(o!==i){q.push(o)}var n=m._getValue("remoteGroupIdNode");if(n!==i){q.push(n)}if(m._isChecked("secureConnectionNode")){q.push(Liferay.Language.get("use-a-secure-network-connection"))}if(m._isChecked("remoteDeletePortletDataNode")){q.push(Liferay.Language.get("delete-portlet-data-before-importing"))}m._setLabels("remoteLink","selectedRemote",q.join(", "))},_updateincompleteProcessMessage:function(n,o){var m=this;var p=m.get("incompleteProcessMessageNode");if(p){o.show();if(n||p.hasClass("in-progress")){p.setContent(o);if(n){p.addClass("in-progress");p.show()}}}}}});Liferay.ExportImport=c},"",{requires:["aui-dialog-iframe-deprecated","aui-io-request","aui-modal","aui-parse-content","aui-toggler","aui-tree-view","liferay-notice","liferay-portlet-base","liferay-store","liferay-util-window"]});